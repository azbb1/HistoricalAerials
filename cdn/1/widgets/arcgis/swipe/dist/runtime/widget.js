System.register(["jimu-core","jimu-arcgis","jimu-ui","esri/widgets/Swipe","jimu-ui/basic/list-tree","jimu-core/dnd","esri/widgets/Legend"],(function(e,t){var n={},r={},l={},i={},a={},o={},s={};return{setters:[function(e){n.AppMode=e.AppMode,n.DataSourceManager=e.DataSourceManager,n.Immutable=e.Immutable,n.React=e.React,n.ReactRedux=e.ReactRedux,n.classNames=e.classNames,n.css=e.css,n.getAppStore=e.getAppStore,n.hooks=e.hooks,n.jsx=e.jsx,n.polished=e.polished},function(e){r.DataSourceTypes=e.DataSourceTypes,r.JimuMapViewComponent=e.JimuMapViewComponent,r.MapViewManager=e.MapViewManager},function(e){l.Alert=e.Alert,l.CollapsablePanel=e.CollapsablePanel,l.DistanceUnits=e.DistanceUnits,l.Icon=e.Icon,l.Switch=e.Switch,l.WidgetPlaceholder=e.WidgetPlaceholder,l.defaultMessages=e.defaultMessages},function(e){i.default=e.default},function(e){a.List=e.List},function(e){o.interact=e.interact},function(e){s.default=e.default}],execute:function(){e((()=>{var e={48623:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M9 0v20h1V0H9ZM0 3.5A1.5 1.5 0 0 1 1.5 2h5v1h-5a.5.5 0 0 0-.5.5v13a.5.5 0 0 0 .5.5h5v1h-5A1.5 1.5 0 0 1 0 16.5v-13ZM20 16.5a1.5 1.5 0 0 1-1.5 1.5h-6v-1h6a.5.5 0 0 0 .5-.5v-13a.5.5 0 0 0-.5-.5h-6V2h6A1.5 1.5 0 0 1 20 3.5v13Z"></path><path fill="#000" d="m6.354 6.646.707.708L4.414 10l2.647 2.646-.707.708L3 10l3.354-3.354ZM12 12.646l.707.707L16.061 10l-3.354-3.354-.707.708L14.646 10 12 12.646Z"></path></svg>'},73982:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M7.5 1.5a.5.5 0 0 1 1 0v2.8a.5.5 0 0 1-1 0V1.5Zm6.028.874a.5.5 0 0 1 .062.705l-1.414 1.685a.5.5 0 1 1-.766-.643l1.414-1.685a.5.5 0 0 1 .704-.062Zm-10.352.062a.5.5 0 1 0-.766.643l1.414 1.685a.5.5 0 0 0 .766-.643L3.176 2.436ZM6.244 10.6H5.43h.814ZM.961 9.8h4.88c.211 0 .359.19.359.4a1.8 1.8 0 0 0 3.555.4h.814a2.6 2.6 0 0 1-5.139 0H.8v3.6h14.4v-3.6H9.755c.03-.129.045-.263.045-.4 0-.21.148-.4.358-.4h4.881l-2.267-3.4H3.228L.961 9.8Zm11.81-4.2a.8.8 0 0 1 .666.356l2.429 3.642a.8.8 0 0 1 .134.444V14.2a.8.8 0 0 1-.8.8H.8a.8.8 0 0 1-.8-.8v-4.158a.8.8 0 0 1 .134-.444l2.429-3.642a.8.8 0 0 1 .665-.356h9.544Z" clip-rule="evenodd"></path></svg>'},79964:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667L8 2.125Zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47L7.118 1.653ZM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995Zm1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" clip-rule="evenodd"></path></svg>'},46771:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="nonzero" d="m6 11.943 4 1.711V4.057L6 2.346v9.597Zm-1 .17V2.494l-4 1.48v9.619l4-1.48Zm6 1.393 4-1.48V2.407l-4 1.48v9.619ZM0 15V3.307L5.75 1.18l4.528 1.937L16 1v11.693l-5.75 2.127-4.528-1.937L0 15Z"></path></svg>'},91915:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="nonzero" d="M7.5 4V1.39C6.402 2.12 5.565 2.99 4.985 4H7.5Zm0 3.5V5H4.512a8.13 8.13 0 0 0-.5 2.5H7.5Zm0 3.5V8.5H4.012a8.13 8.13 0 0 0 .5 2.5H7.5Zm0 3.61V12H4.985c.58 1.01 1.417 1.88 2.515 2.61Zm2.543.087A7.014 7.014 0 0 0 13.745 12h-1.6a8.278 8.278 0 0 1-2.102 2.697ZM11.015 12H8.5v2.61c1.098-.73 1.935-1.6 2.515-2.61Zm1.974-3.5a9.328 9.328 0 0 1-.441 2.5h1.778c.365-.767.594-1.61.656-2.5H12.99Zm-1.001 0H8.5V11h2.988a8.13 8.13 0 0 0 .5-2.5Zm.56-3.5c.254.775.401 1.609.441 2.5h1.993a6.957 6.957 0 0 0-.656-2.5h-1.778Zm-1.06 0H8.5v2.5h3.488a8.13 8.13 0 0 0-.5-2.5Zm-1.445-3.697c.91.78 1.611 1.68 2.102 2.697h1.6a7.014 7.014 0 0 0-3.702-2.697ZM8.5 4h2.515c-.58-1.01-1.417-1.88-2.515-2.61V4Zm-.527 12a8 8 0 1 1 .055-16 8 8 0 0 1-.055 16ZM5.957 1.302A7.014 7.014 0 0 0 2.255 4h1.6a8.278 8.278 0 0 1 2.102-2.697ZM3.011 7.5c.04-.891.187-1.725.441-2.5H1.674a6.957 6.957 0 0 0-.656 2.5H3.01Zm.441 3.5a9.328 9.328 0 0 1-.441-2.5H1.018c.062.89.291 1.733.656 2.5h1.778Zm2.505 3.697A8.278 8.278 0 0 1 3.855 12h-1.6a7.014 7.014 0 0 0 3.702 2.697Z"></path></svg>'},9600:e=>{"use strict";e.exports=s},97629:e=>{"use strict";e.exports=i},26826:e=>{"use strict";e.exports=r},48891:e=>{"use strict";e.exports=n},54020:e=>{"use strict";e.exports=o},30726:e=>{"use strict";e.exports=l},59587:e=>{"use strict";e.exports=a}},t={};function c(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,c),l.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var u={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(u),c.d(u,{__set_webpack_public_path__:()=>oe,default:()=>ae});var e=c(48891),t=c(26826),n=c(30726);const r={_widgetLabel:"Swipe",leadingLayers:"Leading layers",trailingLayers:"Trailing layers",webSceneNotSupported:"Web scenes are not supported.",noConfiguredLayerText:"There is currently no configured layer.",noValidLayerText:"There is no valid layer.",mapOccupiedMsg:"Another active Swipe that connects to the targeted Map has been toggled off."};var l,i,a=c(48623),o=c.n(a);!function(e){e.SimpleHorizontal="SIMPLE_HORIZONTAL",e.SimpleVertical="SIMPLE_VERTICAL",e.AdvancedHorizontal="ADVANCED_HORIZONTAL",e.AdvancedVertical="ADVANCED_VERTICAL"}(l||(l={})),function(e){e.SwipeBetweenLayers="SWIPE_BETWEEN_LAYERS_OF_ONE_MAP",e.SwipeBetweenMaps="SWIPE_BETWEEN_WEBMAPS_OR_WEBSCENES"}(i||(i={}));var s=c(97629);const{useEffect:d,useRef:v}=e.React;function p(t){var n,r;const{widgetId:i,activeMapView:a,leadingLayersId:o,trailingLayersId:c,swipeStyle:u,sliderPosition:p,dividerColor:m,handlerColor:h,isDesignMode:y}=t,g=null===(r=null===(n=(0,e.getAppStore)().getState())||void 0===n?void 0:n.appContext)||void 0===r?void 0:r.isRTL,w=null==a?void 0:a.mapWidgetId,f=v(null),x=u===l.SimpleHorizontal&&g,b=v(x?100-p.distance:p.distance),S=v(document.querySelector(`div[data-widgetid=${w}]`)),L=v(!1);d((()=>{b.current=x?100-p.distance:p.distance}),[x,p]),d((()=>{var e;const t=null===(e=S.current)||void 0===e?void 0:e.querySelector(".esri-swipe");t&&(t.style.pointerEvents=y?null:"none")}),[y,S]);const M=(e,t)=>{return n=this,r=void 0,i=function*(){return yield e.whenJimuLayerViewLoaded(t)},new((l=void 0)||(l=Promise))((function(e,t){function a(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof l?n:new l((function(e){e(n)}))).then(a,o)}s((i=i.apply(n,r||[])).next())}));var n,r,l,i};return d((()=>()=>{L.current=!0}),[]),d((()=>{function e(){var e;f.current&&(f.current.position=0,f.current.leadingLayers.removeAll(),f.current.trailingLayers.removeAll(),null===(e=null==a?void 0:a.view)||void 0===e||e.ui.remove(f.current))}return(null==a?void 0:a.view)&&function(){var t,n;const r=null===(t=null==o?void 0:o.asMutable())||void 0===t?void 0:t.map((e=>M(a,e))),d=null===(n=null==c?void 0:c.asMutable())||void 0===n?void 0:n.map((e=>M(a,e))),v=u===l.SimpleVertical?"vertical":"horizontal";r&&d&&Promise.all(r.concat(d)).then((t=>{if(L.current)return;const n=null==o?void 0:o.asMutable().map((e=>t.filter((t=>t.id===e))[0].layer)),r=null==c?void 0:c.asMutable().map((e=>t.filter((t=>t.id===e))[0].layer));e(),f.current=new s.default({id:i,leadingLayers:n,trailingLayers:r,view:null==a?void 0:a.view,direction:v,position:b.current}),null==a||a.view.ui.add(f.current),f.current.watch("position",(()=>{f.current.position&&(b.current=f.current.position)})),f.current.when((()=>{if(L.current)return void e();S.current.querySelector(".esri-swipe__divider").style.backgroundColor=m;const t=S.current.querySelector(".esri-swipe__handle");t&&(t.style.backgroundColor=h)}))}))}(),()=>{e()}}),[i,a,p,o,c,u,m,h]),null}var m=c(59587);const h=t=>{const{layerList:n,onChange:r,isAllowDeactivateLayers:l,highlightIndex:i}=t,[a,o]=e.React.useState((()=>null==n?void 0:n.map((e=>({itemKey:e.layerId,itemStateTitle:e.title,itemStateChecked:!!l&&e.selected,itemStateDisabled:!e.visible,isCheckboxDisabled:!e.visible})))));return e.React.useEffect((()=>{const e=null==n?void 0:n.map((e=>({itemKey:e.layerId,itemStateTitle:e.title,itemStateChecked:!!l&&e.selected,itemStateDisabled:!e.visible,isCheckboxDisabled:!e.visible})));o(e)}),[n,l]),(0,e.jsx)("div",{className:"layer-list",css:y(i)},(0,e.jsx)(m.List,{size:"default",className:"w-100",itemsJson:a,isMultiSelection:l,dndEnabled:!1,disableDoubleClickTitle:!0,onUpdateItem:(e,t)=>{if(!l)return;const[n,i]=e.itemJsons;o([...i]),r(n.itemKey)}}))};function y(t){return e.css`
    .jimu-tree-item_template-card .jimu-tree-item__body:hover {
      background-color: transparent !important;
    }
    .jimu-tree-main {
      .jimu-tree-item:nth-of-type(${t}) {
        .jimu-tree-item__body {
          border-left: .125rem solid var(--primary) !important;
        }
      }
    }
  `}var g=c(73982),w=c.n(g);const f=t=>{const n=window.SVG,{className:r}=t,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(n[r[l]]=e[r[l]])}return n}(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",r);return n?e.React.createElement(n,Object.assign({className:i,src:w()},l)):e.React.createElement("svg",Object.assign({className:i},l))},x=t=>{const{swipeLayerMode:n}=t,l=e.hooks.useTranslation(r);return(0,e.jsx)("div",{css:b,className:"no-layer-placeholder w-100"},(0,e.jsx)("div",{className:"no-layer-placeholder-icon"},(0,e.jsx)(f,{size:32,color:"var(--dark-500)"})),(0,e.jsx)("div",{className:"no-layer-placeholder-text"},(0,e.jsx)("span",null,l(n?"noConfiguredLayerText":"noValidLayerText"))))},b=e.css`
.no-layer-placeholder-text, .no-layer-placeholder-icon{
  display: table;
  margin: 0 auto;
}
.no-layer-placeholder-text {
  color: var(--dark-500);
  font-size: 13px;
  margin-top: 16px;
  text-align: center;
}
.no-layer-placeholder-icon {
  color: var(--dark-800);
}
`;const{useState:S,useEffect:L,useRef:M}=e.React;function I(t){var l,i,a,o;const{swipeMapViewList:s,activeMapView:c,isAllowDeactivateLayers:u,handlePanelSelectedLeadingLayers:d,handlePanelSelectedTrailingLayers:v}=t,[p,m]=S(!1),[y,g]=S(!1),[w,f]=S([]),[b,I]=S([]),E=e.hooks.useTranslation(r),[V,A]=S(null),[C,O]=S(null),N=M(V),P=M(C),[D,$]=S((null===(l=null==s?void 0:s[null==c?void 0:c.id])||void 0===l?void 0:l.leadingLayersId)||(0,e.Immutable)([])),[R,T]=S((null===(i=null==s?void 0:s[null==c?void 0:c.id])||void 0===i?void 0:i.trailingLayersId)||(0,e.Immutable)([])),k=(e,t)=>{return n=this,r=void 0,i=function*(){return yield e.whenJimuLayerViewLoaded(t)},new((l=void 0)||(l=Promise))((function(e,t){function a(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof l?n:new l((function(e){e(n)}))).then(a,o)}s((i=i.apply(n,r||[])).next())}));var n,r,l,i};L((()=>{var t,n,r,l,i,a;const o=null===(r=null===(n=null===(t=null==s?void 0:s[null==c?void 0:c.id])||void 0===t?void 0:t.leadingLayersId)||void 0===n?void 0:n.asMutable())||void 0===r?void 0:r.map((e=>k(c,e)));o&&Promise.all(o).then((t=>{const n=t.map((e=>({layerId:e.id,title:e.layer.title,selected:!0,visible:e.layer.visible,allowOperation:u})));A(n),N.current=n;const r=[];null==n||n.forEach((e=>{e.selected&&r.push(e.layerId)})),d((0,e.Immutable)(r))}));const p=null===(a=null===(i=null===(l=null==s?void 0:s[null==c?void 0:c.id])||void 0===l?void 0:l.trailingLayersId)||void 0===i?void 0:i.asMutable())||void 0===a?void 0:a.map((e=>k(c,e)));p&&Promise.all(p).then((t=>{const n=t.map((e=>({layerId:e.id,title:e.layer.title,selected:!0,visible:e.layer.visible,allowOperation:u})));O(n),P.current=n;const r=[];null==n||n.forEach((e=>{e.selected&&r.push(e.layerId)})),v((0,e.Immutable)(r))}))}),[s,c,u,d,v]),L((()=>((()=>{var t,n,r,l,i,a;const o=null===(r=null===(n=null===(t=null==s?void 0:s[null==c?void 0:c.id])||void 0===t?void 0:t.leadingLayersId)||void 0===n?void 0:n.asMutable())||void 0===r?void 0:r.map((e=>k(c,e)));o&&Promise.all(o).then((t=>{t.forEach((t=>{const n=[...w];n.push(t.layer.watch("visible",(()=>{const n=t.layer.visible,r=JSON.parse(JSON.stringify(N.current));r.forEach((e=>{e.layerId===t.id&&(e.visible=n)})),A((0,e.Immutable)(r)),N.current=(0,e.Immutable)(r)}))),f(n)}))}));const u=null===(a=null===(i=null===(l=null==s?void 0:s[null==c?void 0:c.id])||void 0===l?void 0:l.trailingLayersId)||void 0===i?void 0:i.asMutable())||void 0===a?void 0:a.map((e=>k(c,e)));u&&Promise.all(u).then((t=>{t.forEach((t=>{const n=[...b];n.push(t.layer.watch("visible",(()=>{const n=t.layer.visible,r=JSON.parse(JSON.stringify(P.current));r.forEach((e=>{e.layerId===t.id&&(e.visible=n)})),O((0,e.Immutable)(r)),P.current=(0,e.Immutable)(r)}))),I(n)}))}))})(),()=>{w.forEach((e=>{e.remove()})),b.forEach((e=>{e.remove()}))})),[s,c]),L((()=>{d(D)}),[d,D]),L((()=>{v(R)}),[v,R]);const _=()=>{m(!p)},q=()=>{g(!y)};return(0,e.jsx)("div",{css:j},(0,e.jsx)(n.CollapsablePanel,{className:"swipe-collapse",label:E("leadingLayers"),isOpen:p,"aria-label":E("leadingLayers"),onRequestOpen:_,onRequestClose:_},(null===(a=null==s?void 0:s[null==c?void 0:c.id])||void 0===a?void 0:a.leadingLayersId.length)>0?(0,e.jsx)(h,{layerList:V,onChange:t=>{const n=JSON.parse(JSON.stringify(V));n.forEach((e=>{e.layerId===t&&(e.selected=!e.selected)})),A((0,e.Immutable)(n));const r=[];n.forEach((e=>{e.selected&&r.push(e.layerId)})),$((0,e.Immutable)(r))},isAllowDeactivateLayers:u}):(0,e.jsx)(x,{swipeLayerMode:!0})),(0,e.jsx)(n.CollapsablePanel,{className:"swipe-collapse",label:E("trailingLayers"),isOpen:y,"aria-label":E("trailingLayers"),onRequestOpen:q,onRequestClose:q},(null===(o=null==s?void 0:s[null==c?void 0:c.id])||void 0===o?void 0:o.trailingLayersId.length)>0?(0,e.jsx)(h,{layerList:C,onChange:t=>{const n=JSON.parse(JSON.stringify(C));n.forEach((e=>{e.layerId===t&&(e.selected=!e.selected)})),O((0,e.Immutable)(n));const r=[];n.forEach((e=>{e.selected&&r.push(e.layerId)})),T((0,e.Immutable)(r))},isAllowDeactivateLayers:u}):(0,e.jsx)(x,{swipeLayerMode:!0})))}const j=e.css`
.swipe-collapse {
  margin-top: 16px;
}
.layer-list {
  margin-top: 12px;
  margin-bottom: 16px;
}
.no-layer-placeholder {
  margin-top: 16px;
  margin-bottom: 16px;
}
`;var E=c(54020);const V=(e,t)=>{if((null==e?void 0:e.length)!==(null==t?void 0:t.length))return!1;const n=[...e].sort(),r=[...t].sort();for(let e=0;e<n.length;e++)if(n[e]!==r[e])return!1;return!0},A=n=>{var r;return(null===(r=e.DataSourceManager.getInstance().getDataSource(n))||void 0===r?void 0:r.type)===t.DataSourceTypes.WebMap},{useRef:C,useEffect:O,useState:N}=e.React,P="\n  position: absolute;\n  border: 1px solid rgba(110,110,110,.5);\n",D="\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(110,110,110,.5);\n  borderRadius: 2px;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n";function $(n){var r,i,a,o,s,c;const{activeMapView:u,widgetId:d,swipeMode:v,swipeStyle:p,sliderPosition:m,mapUseDataSourcesOrderList:h,mapUseDataSources:y,dividerColor:g,handlerColor:w,isDesignMode:f}=n,x=null===(i=null===(r=(0,e.getAppStore)().getState())||void 0===r?void 0:r.appContext)||void 0===i?void 0:i.isRTL,b=u.mapWidgetId,S=C(null===(a=u.view)||void 0===a?void 0:a.width),L=C(null===(o=u.view)||void 0===o?void 0:o.height),M=`jimu-widget-swipe-${d}-handle-container`,I=V(y,h)?h:y,j=C((null==I?void 0:I[0])===(null==u?void 0:u.dataSourceId)),A=C(!1),$=C(!1),R={x:0,y:0},T=C(document.querySelector(`div[data-widgetid=${b}] .multi-map-container`)),k=C(null===(s=T.current)||void 0===s?void 0:s.querySelector(".multisourcemap-item-appear-noanimate")),_=C(null===(c=T.current)||void 0===c?void 0:c.querySelector(".multisourcemap-item-disappear-noanimate"));if(p===l.SimpleVertical)R.y=L.current*m.distance*.01;else{const e=x?100-m.distance:m.distance;R.x=S.current*e*.01}const[q,Z]=N(R),z=C(),J=C(),H=t.MapViewManager.getInstance().getJimuMapViewGroup(b);O((()=>{u.isCached()||(T.current.style.pointerEvents=f?"none":null)}),[f]),O((()=>()=>{T.current&&(T.current.style.pointerEvents=null)}),[]),e.hooks.useUpdateEffect((()=>{j.current=!j.current}),[u]),O((()=>{if(!u.isCached())return k.current=T.current.querySelector(".multisourcemap-item-appear-noanimate"),_.current=T.current.querySelector(".multisourcemap-item-disappear-noanimate"),$.current=!1,A.current=!1,F(),B(),W(),Y(),u.hideMapTools(),()=>{U()}}),[u,g,w]),O((()=>{const e=u.view.on("resize",(e=>{S.current=e.width,L.current=e.height,U(),F(),B(),W(),Y(),u.hideMapTools()}));return()=>{e.remove()}}),[u,g,w]),O((()=>{const e=()=>{A.current=!1},t=()=>{T.current=document.querySelector(`div[data-widgetid=${b}] .multi-map-container`),k.current=T.current.querySelector(".multisourcemap-item-appear-noanimate"),_.current=T.current.querySelector(".multisourcemap-item-disappear-noanimate"),F(),B(),W(),Y(),u.hideMapTools()};return u.addCacheListener(e),u.addRestoreListener(t),()=>{u.removeCacheListener(e),u.removeRestoreListener(t),U()}}),[u,g,w]),O((()=>{Z(R)}),[v]),e.hooks.useUpdateEffect((()=>{if(u.isCached())return;j.current=!j.current,_.current&&(_.current.style.clipPath=null);const e=(null==I?void 0:I[0])===(null==u?void 0:u.dataSourceId);if(p===l.SimpleVertical){const t=e?L.current-q.y:q.y;k.current&&(k.current.style.clipPath=e?`inset(0px 0px ${t}px 0px)`:`inset(${t}px 0px 0px 0px)`)}else{const t=e?S.current-q.x:q.x;k.current&&(k.current.style.clipPath=e?`inset(0px ${t}px 0px 0px)`:`inset(0px 0px 0px ${t}px)`)}}),[I]),O((()=>{if(u.isCached())return;const e={x:0,y:0},t=document.querySelector(`.jimu-widget-swipe-${d}-handle-container`);if(p===l.SimpleVertical)e.y=L.current*m.distance*.01,t.style.transform=`translateY(${e.y}px)`;else{const n=x?100-m.distance:m.distance;e.x=S.current*n*.01;const r=x?-(S.current-e.x):e.x;t.style.transform=`translateX(${r}px)`}B(e),Z(e),u.hideMapTools()}),[m,d,p,x]);const F=()=>{(_.current||k.current)&&_.current&&(_.current.style.opacity="1")},B=e=>{const t=e||q;if(_.current&&(_.current.style.clipPath=null),p===l.SimpleVertical){const e=j.current?L.current-t.y:t.y;k.current&&(k.current.style.clipPath=j.current?`inset(0px 0px ${e}px 0px)`:`inset(${e}px 0px 0px 0px)`)}else{const e=j.current?S.current-t.x:t.x;k.current&&(k.current.style.clipPath=j.current?`inset(0px ${e}px 0px 0px)`:`inset(0px 0px 0px ${e}px)`)}},W=()=>{var e;if(document.getElementsByClassName(M)[0])return!1;(()=>{var e,t;const n=parseInt(null===(t=null===(e=k.current)||void 0===e?void 0:e.style)||void 0===t?void 0:t.zIndex)+1;if(p===l.SimpleVertical){J.current=document.createElement("div"),J.current.className=M,J.current.setAttribute("style",P),J.current.style.transform=`translateY(${q.y}px)`,J.current.style.width=`${S.current}px`,J.current.style.height="4px",J.current.style.backgroundColor=g,J.current.style.zIndex=String(n);const e=document.createElement("div");e.className="handler esri-swipe__handle-icon esri-icon-drag-horizontal",e.setAttribute("style",D),e.style.top="-13px",e.style.backgroundColor=w,e.style.left="50%",e.style.marginLeft="-16px",e.style.cursor="row-resize",J.current.appendChild(e)}else{J.current=document.createElement("div"),J.current.className=M,J.current.setAttribute("style",P);const e=x?-(S.current-q.x):q.x;J.current.style.transform=`translateX(${e}px)`,J.current.style.height=`${L.current}px`,J.current.style.width="4px",J.current.style.backgroundColor=g,J.current.style.zIndex=String(n);const t=document.createElement("div");t.className="handler esri-swipe__handle-icon esri-icon-drag-vertical",t.setAttribute("style",D),t.style.left="-13px",t.style.backgroundColor=w,t.style.top="50%",t.style.marginTop="-16px",t.style.cursor="col-resize",J.current.appendChild(t)}})(),null===(e=T.current)||void 0===e||e.appendChild(J.current),z.current=(e=>{var t,n;return e&&p===l.SimpleVertical?null===(t=(0,E.interact)(e))||void 0===t?void 0:t.draggable({startAxis:"y",lockAxis:"y",listeners:{move(e){q.y+=e.dy,q.y=q.y>L.current?L.current:q.y>0?q.y:0,Z(q),B(q),e.target.style.transform=`translateY(${q.y}px)`}}}):e&&p===l.SimpleHorizontal?null===(n=(0,E.interact)(e))||void 0===n?void 0:n.draggable({startAxis:"x",lockAxis:"x",listeners:{move(e){q.x+=e.dx,q.x=q.x>S.current?S.current:q.x>0?q.x:0,Z(q),B(q);const t=x?-(S.current-q.x):q.x;e.target.style.transform=`translateX(${t}px)`}}}):void 0})(J.current)},U=()=>{A.current=!1,document.getElementsByClassName(M)[0]&&T.current&&J.current&&T.current.removeChild(J.current),z.current&&z.current.unset(),u.showMapTools(),(_.current||k.current)&&(_.current&&(_.current.style.opacity=null),k.current&&(k.current.style.clipPath=null),_.current&&(_.current.style.clipPath=null),k.current&&(k.current.style.opacity=null)),k.current.removeEventListener("click",G),_.current.removeEventListener("click",G),k.current.removeEventListener("wheel",G),_.current.removeEventListener("wheel",G)},Y=(e=!1)=>{_.current&&!A.current&&(k.current.addEventListener("click",G),_.current.addEventListener("click",G),k.current.addEventListener("wheel",G),_.current.addEventListener("wheel",G),A.current=!0)},G=e=>{if(e.currentTarget.classList.contains("multisourcemap-item-disappear-noanimate")){if($.current)return;$.current=!0,H.switchMap()}};return null}function R(r){const{mapUseDataSourcesOrderList:l,mapUseDataSources:i}=r,a=V(i,l)?l:i,o=t=>{if(!t)return"";const n=e.DataSourceManager.getInstance().getDataSource(t);return(null==n?void 0:n.getLabel())||(null==n?void 0:n.getDataSourceJson().sourceLabel)||t},s=n=>{var r;return c((null===(r=e.DataSourceManager.getInstance().getDataSource(n))||void 0===r?void 0:r.type)===t.DataSourceTypes.WebMap?46771:91915)};return(0,e.jsx)("div",{css:T},(0,e.jsx)("div",{className:"swipe-maps-panel"},(0,e.jsx)("div",{className:"swipe-maps-list d-flex justify-content-start"},(0,e.jsx)("div",{className:"d-flex flex-shrink-0 justify-content-center align-items-center swipe-maps-thumbnail"},(0,e.jsx)(n.Icon,{size:"12",color:"#FFFFFF",icon:s(a[0])})),(0,e.jsx)("div",{title:o(a[0]),className:"swipe-maps-label text-truncate"},o(a[0]))),(0,e.jsx)("div",{className:"swipe-maps-list d-flex justify-content-start"},(0,e.jsx)("div",{className:"d-flex flex-shrink-0 justify-content-center align-items-center swipe-maps-thumbnail"},(0,e.jsx)(n.Icon,{size:"12",color:"#FFFFFF",icon:s(a[1])})),(0,e.jsx)("div",{title:o(a[1]),className:"swipe-maps-label text-truncate"},o(a[1])))))}const T=e.css`
.swipe-maps-panel {
  margin-top: 16px;
  .swipe-maps-list{
    width: 100%;
    margin-bottom: 14px;
    .swipe-maps-thumbnail {
      width:  20px;
      height:  20px;
      background-color: #089BDC;
      margin-right: 8px;
    }
    .swipe-maps-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--dark-800);
    }
  }
}
`;const{useState:k,useEffect:_,useRef:q}=e.React,Z="\n  position: absolute;\n  border: 1px solid rgba(110,110,110,.5);\n";function z(e){const{widgetId:t,activeMapView:n,inactiveMapView:r,firstTrailingLayersId:i,secondTrailingLayersId:a,swipeStyle:o,handleScrollingLayerOfFirstMapView:c,handleScrollingLayerOfSecondMapView:u,handleScrollFirstMapView:d,dividerColor:v,isDesignMode:p}=e,m=n.mapWidgetId,h=q(null),y=q(null),[g,w]=k(0),[f,x]=k((null==i?void 0:i.length)>0),b=q(f),[S,L]=k(null==n?void 0:n.view.height),[M,I]=k(null==n?void 0:n.view.width),j=q(document.querySelector(`div[data-widgetid=${m}] .widget-content`)),E=(e,t)=>e.current.querySelector(`div[data-widgetid=${t}] .multi-map-container`),V=q(E(j,m)),C=e=>{var t;return null===(t=e.current)||void 0===t?void 0:t.querySelector(".multisourcemap-item-appear-noanimate")},O=q(C(V)),N=e=>{var t;return null===(t=e.current)||void 0===t?void 0:t.querySelector(".multisourcemap-item-disappear-noanimate")},P=q(N(V)),D=q([]),$=null==n?void 0:n.view,R=q(0),T=q(!1),z=q(!1),J=q(0),H=q(0),F=q(null),B=q(null),W=q(null),[U,Y]=k(0),G=q([]),X=q(0),K=`jimu-widget-swipe-${t}-handle-container`,Q=`jimu-widget-swipe-${t}-scroller`,ee=`jimu-widget-swipe-${t}-content`,te=q(),ne=q(!0),re=q(!0),le=(e,t)=>{return n=this,r=void 0,i=function*(){return yield e.whenJimuLayerViewLoaded(t)},new((l=void 0)||(l=Promise))((function(e,t){function a(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof l?n:new l((function(e){e(n)}))).then(a,o)}s((i=i.apply(n,r||[])).next())}));var n,r,l,i};_((()=>{j.current.style.pointerEvents=p?"none":null}),[p]),_((()=>()=>{j.current.style.pointerEvents=null}),[]),_((()=>{L(null==n?void 0:n.view.height),I(null==n?void 0:n.view.width)}),[n]),_((()=>{const e=()=>{V.current=E(j,m),O.current=C(V),P.current=N(V),b.current||void 0===a||0===a.length||(o===l.AdvancedVertical?O.current.style.clipPath=`inset(0px 0px ${n.view.width}px 0px)`:O.current.style.clipPath=`inset(0px ${n.view.height}px 0px 0px)`),(null==a?void 0:a.length)>0&&(P.current.style.opacity="1")};return n.addRestoreListener(e),()=>{n.removeRestoreListener(e)}}),[n,m,a,o]),_((()=>{const e=()=>{n.hideMapTools()};function c(){var e;const n=o===l.AdvancedVertical?"vertical":"horizontal",i=null===(e=null==a?void 0:a.asMutable())||void 0===e?void 0:e.map((e=>le(r,e)));i&&Promise.all(i).then((e=>{var l,i;const a=e.map((e=>e.layer));G.current=null==a?void 0:a.map((e=>new s.default({id:t,view:null==r?void 0:r.view,disabled:!0,position:100,direction:n,trailingLayers:[e],visibleElements:{handle:!1,divider:!0}})));const o=null===(l=null==G?void 0:G.current)||void 0===l?void 0:l[0];null===(i=null==r?void 0:r.view)||void 0===i||i.ui.add(o),null==o||o.leadingLayers.addMany(o.trailingLayers),null==o||o.trailingLayers.removeAll(),ne.current=!0}))}function u(){function e(){o===l.AdvancedVertical?t(B.current.scrollTop-S*((null==i?void 0:i.length)||0)):t(B.current.scrollLeft-M*((null==i?void 0:i.length)||0))}function t(e){X.current=e,z.current||(requestAnimationFrame((()=>{var e,t;z.current=!1;const n=o===l.AdvancedVertical?X.current/$.height:X.current/$.width,i=(null===(e=null==G?void 0:G.current)||void 0===e?void 0:e.length)-1;null===(t=null==G?void 0:G.current)||void 0===t||t.forEach(((e,t,l)=>{var a;null===(a=null==r?void 0:r.view)||void 0===a||a.ui.add(e),e.when((()=>{j.current.querySelectorAll(".esri-swipe__divider").forEach((function(e){e.style.backgroundColor=v}))}));let o=100*(t-n);0===t&&e.leadingLayers.length&&ne.current&&(e.trailingLayers.addMany(e.leadingLayers),e.leadingLayers.removeAll(),ne.current=!1),o<0&&e.trailingLayers.length?(e.leadingLayers.addMany(e.trailingLayers),e.trailingLayers.removeAll(),Y(t)):o>=0&&e.leadingLayers.length&&(e.trailingLayers.addMany(e.leadingLayers),e.leadingLayers.removeAll(),Y(t)),o>=0&&o<.1&&t===i&&Y(t),o<0&&(o+=100),e.position=ie(o,0,100)}))})),z.current=!0)}function n(){o===l.AdvancedVertical?t(B.current.scrollTop-S*((null==i?void 0:i.length)||0)):t(B.current.scrollLeft-M*((null==i?void 0:i.length)||0))}(()=>{const e=j.current.querySelector(`#${Q}`),t=j.current.querySelector(`#${ee}`);B.current=e,W.current=t})(),(()=>{var t;const i=o===l.AdvancedVertical?"vertical":"horizontal",s=null===(t=null==a?void 0:a.asMutable())||void 0===t?void 0:t.map((e=>le(r,e)));s&&Promise.all(s).then((t=>{var l,a;"vertical"===i?null===(l=null==r?void 0:r.view)||void 0===l||l.watch("height",n):null===(a=null==r?void 0:r.view)||void 0===a||a.watch("width",n),n(),B.current.addEventListener("scroll",e),"horizontal"===i&&B.current.addEventListener("wheel",oe)}))})()}function d(){o===l.AdvancedVertical?p(h.current.scrollTop):p(h.current.scrollLeft)}function p(e){R.current=e,T.current||(requestAnimationFrame((()=>{var e;T.current=!1;const t=o===l.AdvancedVertical?R.current/$.height:R.current/$.width,n=(null===(e=D.current)||void 0===e?void 0:e.length)-1;D.current.forEach(((e,s,c)=>{$.ui.add(e),e.when((()=>{j.current.querySelectorAll(".esri-swipe__divider").forEach((function(e){e.style.backgroundColor=v}))}));let d=100*(s-t);d<0&&e.trailingLayers.length?(e.leadingLayers.addMany(e.trailingLayers),e.trailingLayers.removeAll(),w(s)):d>=0&&e.leadingLayers.length&&(e.trailingLayers.addMany(e.leadingLayers),e.leadingLayers.removeAll(),w(s)),(0===d||d<-100)&&(r&&A(r.dataSourceId)&&(null==a?void 0:a.length)>0&&re.current&&(function(){const e=()=>{const e=j.current.querySelector(`#${Q}`),t=(null==i?void 0:i.length)>0?S*((null==i?void 0:i.length)-1):0;J.current=e.scrollTop-t,O.current.style.clipPath=`inset(0px 0px ${J.current}px 0px)`,J.current<S&&(x(!0),b.current=!0),J.current>=S&&(u(),x(!1),b.current=!1)},t=e=>{e.preventDefault();const t=j.current.querySelector(`#${Q}`),n=(null==i?void 0:i.length)>0?M*((null==i?void 0:i.length)-1):0;H.current=t.scrollLeft-n,O.current.style.clipPath=`inset(0px ${H.current}px 0px 0px)`,H.current<M&&x(!0),H.current>=M&&(u(),x(!1))};var n,r,a,s;(()=>{const n=j.current.querySelector(`#${Q}`);F.current=n,o===l.AdvancedVertical?n.addEventListener("scroll",e):n.addEventListener("scroll",t)})(),P.current.style.opacity="1",o===l.AdvancedVertical?(te.current=document.createElement("div"),te.current.id=K,te.current.setAttribute("style",Z),te.current.style.transform=`translateY(${S}px`,te.current.style.width=`${M}px`,te.current.style.height="4px",te.current.style.backgroundColor=v,te.current.style.zIndex=null===(r=null===(n=O.current)||void 0===n?void 0:n.style)||void 0===r?void 0:r.zIndex):(te.current=document.createElement("div"),te.current.id=K,te.current.setAttribute("style",Z),te.current.style.transform=`translateX(${M})px`,te.current.style.height=`${S}px`,te.current.style.width="4px",te.current.style.backgroundColor=v,te.current.style.zIndex=null===(s=null===(a=O.current)||void 0===a?void 0:a.style)||void 0===s?void 0:s.zIndex),V.current.appendChild(te.current)}(),re.current=!1),s===n&&w(s)),d<0&&(d+=100),e.position=ie(d,0,100)}))})),T.current=!0)}function m(){o===l.AdvancedVertical?p(h.current.scrollTop):p(h.current.scrollLeft)}return(null==n?void 0:n.view)&&j.current&&(function(){const e=document.createElement("div");e.id=Q;const t=document.createElement("div");t.className="content",o===l.AdvancedVertical?(e.setAttribute("style","\n  position: absolute;\n  overflow-y: scroll;\n  z-index: 999;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n"),t.setAttribute("style","\n  padding: 0;\n  margin: 0;\n  display: flex;\n  flexDirection: column;\n  alignItems: stretch;\n  alignContent: stretch;\n  justifyContent: space-evenly;\n"),t.style.height=S*(((null==i?void 0:i.length)||0)+((null==a?void 0:a.length)||0))+"px"):(e.setAttribute("style","\n  position: absolute;\n  overflow-x: scroll;\n  z-index: 999;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n"),t.setAttribute("style","\n  padding: 0;\n  margin: 0;\n  height: 100%;\n  display: flex;\n  flexDirection: row;\n  alignItems: stretch;\n  alignContent: stretch;\n  justifyContent: space-evenly;\n"),t.style.width=M*(((null==i?void 0:i.length)||0)+((null==a?void 0:a.length)||0))+"px"),j.current.appendChild(e),e.appendChild(t),h.current=e,y.current=t}(),(null==i?void 0:i.length)>0?(function(){var e;const r=o===l.AdvancedVertical?"vertical":"horizontal",a=null===(e=null==i?void 0:i.asMutable())||void 0===e?void 0:e.map((e=>le(n,e)));a&&Promise.all(a).then((e=>{const l=e.map((e=>e.layer));D.current=null==l?void 0:l.map((e=>new s.default({id:t,view:null==n?void 0:n.view,disabled:!0,position:100,direction:r,trailingLayers:[e],visibleElements:{handle:!1,divider:!0}}))),"vertical"===r?$.watch("height",m):$.watch("width",m),m(),h.current.addEventListener("scroll",d),"horizontal"===r&&h.current.addEventListener("wheel",ae)}))}(),r&&c(),e(),re.current=!0):(null==a?void 0:a.length)>0&&(P.current.style.opacity="1",o===l.AdvancedVertical?O.current.style.clipPath=`inset(0px 0px ${n.view.width}px 0px)`:O.current.style.clipPath=`inset(0px ${n.view.height}px 0px 0px)`,x(!1),b.current=!1,r&&c(),u(),e())),()=>{var e;(function(){var e;const t=j.current.querySelector(`#${Q}`);t&&j.current.removeChild(t),null===(e=null==D?void 0:D.current)||void 0===e||e.forEach(((e,t,n)=>{var r;e.position=0,e.leadingLayers.removeAll(),e.trailingLayers.removeAll(),null===(r=$.ui)||void 0===r||r.remove(e)})),n.showMapTools()})(),null===(e=null==G?void 0:G.current)||void 0===e||e.forEach(((e,t,n)=>{var l,i;e.position=0,e.leadingLayers.removeAll(),e.trailingLayers.removeAll(),null===(i=null===(l=null==r?void 0:r.view)||void 0===l?void 0:l.ui)||void 0===i||i.remove(e)})),x(!0),function(){const e=j.current.querySelector(".scrollerMap");e&&j.current.removeChild(e),P.current&&(P.current.style.opacity=null),O.current&&(O.current.style.clipPath=null),te.current&&j.current.querySelector(`#${K}`)&&V.current.contains(te.current)&&V.current.removeChild(te.current)}()}}),[t,$,n,i,a,o,v,K,S,M,Q,ee,r]),_((()=>{var e;const t=null===(e=null==i?void 0:i.asMutable())||void 0===e?void 0:e.map((e=>le(n,e)));t&&Promise.all(t).then((e=>{c(e[g])}))}),[n,i,g,c]),_((()=>{var e;const t=null===(e=null==a?void 0:a.asMutable())||void 0===e?void 0:e.map((e=>le(r,e)));t&&Promise.all(t).then((e=>{u(e[U])}))}),[a,U,r,u]),_((()=>{d(f)}),[d,f]);const ie=(e,t,n)=>Math.min(n,Math.max(t,e)),ae=e=>{e.preventDefault();const t=-e.wheelDelta||30*-e.deltaY;h.current.scrollLeft=h.current.scrollLeft+t/2},oe=e=>{e.preventDefault();const t=-e.wheelDelta||30*-e.deltaY;B.current.scrollLeft=B.current.scrollLeft+t/2};return null}var J=c(9600);const{useState:H,useEffect:F,useRef:B}=e.React;function W(t){var r,l;const{scrollMapViewList:i,activeMapView:a,inactiveMapView:o,handlePanelSelectedFirstScrollLayer:s,handlePanelSelectedSecondScrollLayer:c,isAllowDeactivateLayers:u,scrollingLayerOfFirstMapView:d,scrollingLayerOfSecondMapView:v,scrollFirstMapView:p,showSwipeOnMap:m}=t,[y,g]=H(!1),[w,f]=H(!1),b=B(null),[S,L]=H([]),[M,I]=H([]);F((()=>{o||c((0,e.Immutable)([]))}),[c,o]);const[j,E]=H(null),V=B(j),[C,O]=H((0,e.Immutable)([])),[N,P]=H(null),D=B(N),[$,R]=H((0,e.Immutable)([]));F((()=>{const e=null==i?void 0:i[null==a?void 0:a.id];O(e)}),[i,a]),F((()=>{const e=null==i?void 0:i[null==o?void 0:o.id];R(e)}),[i,o]);const T=(e,t)=>{return n=this,r=void 0,i=function*(){return yield e.whenJimuLayerViewLoaded(t)},new((l=void 0)||(l=Promise))((function(e,t){function a(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof l?n:new l((function(e){e(n)}))).then(a,o)}s((i=i.apply(n,r||[])).next())}));var n,r,l,i},k=e.hooks.useEventCallback((()=>{const e=b.current,t=document.querySelector(".currentLegend");if(t&&t.remove(),m&&((null==C?void 0:C.length)>0||(null==$?void 0:$.length)>0)){const t=document.createElement("div");t.className="currentLegend",new J.default({view:p?null==a?void 0:a.view:null==o?void 0:o.view,style:"classic",layerInfos:[{layer:p?null==d?void 0:d.layer:null==v?void 0:v.layer}]}).container=t,e.appendChild(t)}}));F((()=>{var t,n,r,l;const d=null===(n=null===(t=null==i?void 0:i[null==a?void 0:a.id])||void 0===t?void 0:t.asMutable())||void 0===n?void 0:n.map((e=>T(a,e)));d&&Promise.all(d).then((t=>{const n=t.map((e=>({layerId:e.id,title:null==e?void 0:e.layer.title,selected:!0,visible:null==e?void 0:e.layer.visible,allowOperation:u})));E(n),V.current=n;const r=[];null==n||n.forEach((e=>{e.selected&&e.visible&&r.push(e.layerId)})),O((0,e.Immutable)(r)),s((0,e.Immutable)(r))})).catch((e=>{console.error(e)}));const v=null===(l=null===(r=null==i?void 0:i[null==o?void 0:o.id])||void 0===r?void 0:r.asMutable())||void 0===l?void 0:l.map((e=>T(o,e)));v&&Promise.all(v).then((t=>{const n=t.map((e=>({layerId:e.id,title:null==e?void 0:e.layer.title,selected:!0,visible:null==e?void 0:e.layer.visible,allowOperation:u})));P(n),D.current=n;const r=[];null==n||n.forEach((e=>{e.selected&&e.visible&&r.push(e.layerId)})),R((0,e.Immutable)(r)),c((0,e.Immutable)(r))})).catch((e=>{console.error(e)}))}),[i,a,o,u,s,c]),F((()=>((()=>{var t,n;const r=null===(n=null===(t=null==i?void 0:i[null==a?void 0:a.id])||void 0===t?void 0:t.asMutable())||void 0===n?void 0:n.map((e=>T(a,e)));r&&Promise.all(r).then((t=>{t.forEach((t=>{const n=[...S];n.push(null==t?void 0:t.layer.watch("visible",(()=>{const n=null==t?void 0:t.layer.visible,r=JSON.parse(JSON.stringify(V.current));r.forEach((e=>{e.layerId===t.id&&(e.visible=n)})),E(r),V.current=r;const l=[];null==r||r.forEach((e=>{e.selected&&e.visible&&l.push(e.layerId)})),s((0,e.Immutable)(l))}))),L(n)}))}))})(),(()=>{var t,n;const r=null===(n=null===(t=null==i?void 0:i[null==o?void 0:o.id])||void 0===t?void 0:t.asMutable())||void 0===n?void 0:n.map((e=>T(o,e)));r&&Promise.all(r).then((t=>{t.forEach((t=>{const n=[...M];n.push(null==t?void 0:t.layer.watch("visible",(()=>{const n=null==t?void 0:t.layer.visible,r=JSON.parse(JSON.stringify(D.current));r.forEach((e=>{e.layerId===t.id&&(e.visible=n)})),P(r),D.current=r;const l=[];null==r||r.forEach((e=>{e.selected&&e.visible&&l.push(e.layerId)})),c((0,e.Immutable)(l))}))),I(n)}))}))})(),()=>{S.forEach((e=>{null==e||e.remove()})),M.forEach((e=>{null==e||e.remove()}))})),[i,a,o]),F((()=>{s(C)}),[s,C]),F((()=>{c($)}),[c,$]),F((()=>{(d||v)&&k()}),[k,d,v,a,o,m,p,i,C,$]);const _=()=>{g(!y)},q=()=>{f(!w)},Z=t=>{if(!t)return"";const n=e.DataSourceManager.getInstance().getDataSource(t);return(null==n?void 0:n.getLabel())||(null==n?void 0:n.getDataSourceJson().sourceLabel)||t},z=(e,t,n,r)=>{var l;return t?(null===(l=null==e?void 0:e[null==n?void 0:n.id])||void 0===l?void 0:l.indexOf(null==r?void 0:r.id))+1:-1};return(0,e.jsx)("div",{ref:b,css:U},(0,e.jsx)(n.CollapsablePanel,{className:(0,e.classNames)("swipe-collapse "+(m&&p?"scroll-now":"")),label:Z(a.dataSourceId),isOpen:y,"aria-label":Z(a.dataSourceId),onRequestOpen:_,onRequestClose:_},(null===(r=null==i?void 0:i[null==a?void 0:a.id])||void 0===r?void 0:r.length)>0?(0,e.jsx)(h,{layerList:j,onChange:t=>{const n=JSON.parse(JSON.stringify(j));n.forEach((e=>{e.layerId===t&&(e.selected=!e.selected)})),E(n);const r=[];n.forEach((e=>{e.selected&&e.visible&&r.push(e.layerId)})),O((0,e.Immutable)(r))},isAllowDeactivateLayers:u,highlightIndex:p?z(i,m,a,d):-1}):(0,e.jsx)(x,{swipeLayerMode:!0})),o&&A(o.dataSourceId)&&(0,e.jsx)(n.CollapsablePanel,{className:(0,e.classNames)("swipe-collapse "+(m&&!p&&v?"scroll-now":"")),label:Z(o.dataSourceId),isOpen:w,"aria-label":Z(o.dataSourceId),onRequestOpen:q,onRequestClose:q},(null===(l=null==i?void 0:i[null==o?void 0:o.id])||void 0===l?void 0:l.length)>0?(0,e.jsx)(h,{layerList:N,onChange:t=>{const n=JSON.parse(JSON.stringify(N));n.forEach((e=>{e.layerId===t&&(e.selected=!e.selected)})),P(n);const r=[];n.forEach((e=>{e.selected&&e.visible&&r.push(e.layerId)})),R((0,e.Immutable)(r))},isAllowDeactivateLayers:u,highlightIndex:p?-1:z(i,m,o,v)}):(0,e.jsx)(x,{swipeLayerMode:!0})))}const U=e.css`
  .swipe-collapse {
    margin-top: 16px;
    .layer-list {
      margin-top: 12px;
      margin-bottom: 16px;
    }
    .no-layer-placeholder {
      margin-top: 16px;
      margin-bottom: 16px;
    }
  }
  .currentLegend {
    margin-top: 8px;
    .esri-legend__message, .esri-legend__service{
      padding-left: 0px;
    }
  }
  .scroll-now {
    .collapse-label {
      position: relative;
      &:after {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        content: "";
        display: block;
        position: absolute;
        right: -10px;
        background-color: var(--primary);
      }
    }
  }
`;var Y=c(79964),G=c.n(Y);const X=t=>{const n=window.SVG,{className:r}=t,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(n[r[l]]=e[r[l]])}return n}(t,["className"]),i=(0,e.classNames)("jimu-icon jimu-icon-component",r);return n?e.React.createElement(n,Object.assign({className:i,src:G()},l)):e.React.createElement("svg",Object.assign({className:i},l))},K=e.css`
  &.warning-info {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    .warning-icon {
      color: var(--warning-800);
      width: ${e.polished.rem(22)};
      height: ${e.polished.rem(22)};
      margin-bottom: ${e.polished.rem(10)};
    }
    .warning-text {
      font-size: ${e.polished.rem(13)};
      line-height: ${e.polished.rem(18)};
    }
  }
`;function Q(){const t=e.hooks.useTranslation(r);return(0,e.jsx)("div",{className:"w-100 d-flex flex-column align-items-center warning-info",css:K},(0,e.jsx)(X,{className:"warning-icon"}),(0,e.jsx)("div",{className:"warning-text"},t("webSceneNotSupported")))}l.SimpleHorizontal;const ee={distance:35,unit:n.DistanceUnits.PERCENTAGE},te=e.css`
  &{
    .widget-container {
      overflow: auto;
    }
    .swipe-panel {
      padding: ${e.polished.rem(16)};
    }
    .swipe-title {
      .swipe-label {
        font-size: ${e.polished.rem(14)};
        color: var(--black);
        span {
          margin-left: 0.5rem;
        }
      }
    }
    .error-alert {
      position: absolute;
      bottom: 4px;
      left: 4px;
      z-index: 1;
    }
  }
`,{useState:ne,useEffect:re,useCallback:le,useRef:ie}=e.React,ae=a=>{var s,c,u,d,v;const{id:m,label:h,config:y}=a,{styleConfig:g,scrollMapViewList:w,swipeMapViewList:f,mapUseDataSourcesOrderList:x,swipeStyle:b,swipeMode:S}=y,{isAllowDeactivateLayers:L=!0,sliderPosition:M=ee,dividerColor:j="var(--light)",handleColor:E="var(--light)"}=g||{},V=null===(s=a.useMapWidgetIds)||void 0===s?void 0:s[0],[A,C]=ne(null),[O,N]=ne(null),[P,D]=ne({}),[T,k]=ne(!1),[_,q]=ne(null),[Z,J]=ne(null),[H,F]=ne(!0),[B,U]=ne((0,e.Immutable)([])),[Y,G]=ne((0,e.Immutable)([])),[X,K]=ne((0,e.Immutable)([])),[ae,oe]=ne((0,e.Immutable)([])),[se,ce]=ne((0,e.Immutable)([])),[ue,de]=ne(!1),[ve,pe]=ne(!0),me=ie(null),he=e.hooks.useTranslation(r,n.defaultMessages),ye=b===l.SimpleHorizontal||b===l.SimpleVertical,ge=e.ReactRedux.useSelector((e=>{var t,n;return null===(n=(null!==(t=e.appStateInBuilder)&&void 0!==t?t:e).appConfig.widgets[V])||void 0===n?void 0:n.useDataSources})),we=e.ReactRedux.useSelector((t=>t.appRuntimeInfo.appMode===e.AppMode.Design));re((()=>{ue&&!me.current&&(me.current=setTimeout((()=>{de(!1),me.current=null}),3e3))}),[ue]),re((()=>{const e=null==ge?void 0:ge.map((e=>e.dataSourceId));ce(e)}),[ge]),re((()=>{k(!1)}),[b,V]),re((()=>{var e;const n=null==ge?void 0:ge.filter((e=>e.dataSourceId!==(null==A?void 0:A.dataSourceId))),r=(null==A?void 0:A.mapWidgetId)+"-"+(null===(e=null==n?void 0:n[0])||void 0===e?void 0:e.dataSourceId);const l=t.MapViewManager.getInstance().getJimuMapViewById(r);N(l)}),[A,ge]);const fe=()=>{if(!T){const e=document.querySelector(`.jimu-widget-swipe .useMapWidgetId-${V} .swipe-title .checked:not(.${m})`);e&&(de(!0),e.getElementsByTagName("input")[0].click())}k(!T)},xe=le((e=>{q(e)}),[]),be=le((e=>{J(e)}),[]),Se=le((e=>{F(e)}),[]),Le=le((e=>{U(e)}),[]),Me=le((e=>{G(e)}),[]),Ie=le((e=>{K(e),pe(!0)}),[]),je=le((e=>{oe(e),pe(!0)}),[]),Ee=!ye&&!!A&&(null==se?void 0:se.length)>0&&"2d"===(null===(c=null==A?void 0:A.view)||void 0===c?void 0:c.type)&&P&&Object.keys(P).length>0,Ve=ye&&!!A&&"LOADED"===A.status&&"2d"===(null===(u=null==A?void 0:A.view)||void 0===u?void 0:u.type)&&S===i.SwipeBetweenLayers,Ae=ye&&S===i.SwipeBetweenMaps&&P&&2===Object.keys(P).length&&2===se.length,Ce=T&&b&&!ye&&"2d"===(null===(d=null==A?void 0:A.view)||void 0===d?void 0:d.type)&&(null==se?void 0:se.length)>0&&P&&Object.keys(P).length>0,Oe="2d"===(null===(v=null==A?void 0:A.view)||void 0===v?void 0:v.type)&&((null==X?void 0:X.length)>0||(null==ae?void 0:ae.length)>0),Ne=2===(null==se?void 0:se.length)&&!!A;return(0,e.jsx)("div",{className:"jimu-widget jimu-widget-swipe",css:te},V&&b?(0,e.jsx)("div",{className:"widget-container surface-1 border-0 w-100 h-100"},(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:V,onActiveViewChange:e=>{(null==e?void 0:e.view)?(C(e),pe(!1)):C(null)},onViewsCreate:e=>{const n=t.MapViewManager.getInstance().getJimuMapViewGroup(V);D(n.jimuMapViews)}}),(()=>{var t,r;return(0,e.jsx)("div",{className:(0,e.classNames)(`swipe-panel useMapWidgetId-${V}`)},(0,e.jsx)("div",{className:"swipe-title d-flex justify-content-between"},(0,e.jsx)("div",{className:"swipe-label"},(0,e.jsx)(n.Icon,{icon:o()}),(0,e.jsx)("span",null,h)),(0,e.jsx)("div",null,(0,e.jsx)(n.Switch,{"aria-label":h,title:h,className:m,checked:T,onChange:fe}))),Ee&&(0,e.jsx)(W,{scrollMapViewList:w,activeMapView:A,inactiveMapView:O,handlePanelSelectedFirstScrollLayer:Le,handlePanelSelectedSecondScrollLayer:Me,isAllowDeactivateLayers:L,scrollingLayerOfFirstMapView:_,scrollingLayerOfSecondMapView:Z,scrollFirstMapView:H,showSwipeOnMap:T}),!ye&&"3d"===(null===(t=null==A?void 0:A.view)||void 0===t?void 0:t.type)&&(0,e.jsx)(Q,null),ye&&"3d"===(null===(r=null==A?void 0:A.view)||void 0===r?void 0:r.type)&&S===i.SwipeBetweenLayers&&(0,e.jsx)(Q,null),Ve&&(0,e.jsx)(I,{swipeMapViewList:f,activeMapView:A,isAllowDeactivateLayers:L,handlePanelSelectedLeadingLayers:Ie,handlePanelSelectedTrailingLayers:je}),Ae&&(0,e.jsx)(R,{mapUseDataSourcesOrderList:x,mapUseDataSources:se}),ue&&(0,e.jsx)(n.Alert,{className:"w-100 error-alert",form:"basic",open:!0,withIcon:!0,type:"warning",text:he("mapOccupiedMsg")}))})()):(0,e.jsx)(n.WidgetPlaceholder,{icon:o(),message:he("_widgetLabel")}),T&&b&&ye&&(S===i.SwipeBetweenLayers?Oe&&ve&&(0,e.jsx)(p,{widgetId:m,activeMapView:A,leadingLayersId:X,trailingLayersId:ae,swipeStyle:b,sliderPosition:M,dividerColor:j,handlerColor:E,isDesignMode:we}):Ne&&(0,e.jsx)($,{swipeMode:S,widgetId:m,activeMapView:A,sliderPosition:M,swipeStyle:b,mapUseDataSourcesOrderList:x,mapUseDataSources:se,dividerColor:j,handlerColor:E,isDesignMode:we})),Ce&&(0,e.jsx)(z,{widgetId:m,activeMapView:A,inactiveMapView:O,firstTrailingLayersId:B,secondTrailingLayersId:Y,swipeStyle:b,handleScrollingLayerOfFirstMapView:xe,handleScrollingLayerOfSecondMapView:be,handleScrollFirstMapView:Se,dividerColor:j,isDesignMode:we}))};function oe(e){c.p=e}})(),u})())}}}));